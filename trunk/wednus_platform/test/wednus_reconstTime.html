<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Test - wednus.js</title>
<script type='text/javascript' src='../wednus.js'></script>
<script type='text/javascript'>
W.module('debug');  // W.test, W.Timer
</script>

<script type='text/javascript'>
W.event(window, 'onload', parse);

function parse(){
    var timer = new W.Timer();
    var tmp = W.$('code').value;
    timer.start();
    var W2 = eval(tmp);
    W.test(typeof W2.js == 'function', 'W construction time from string');
    timer.finish();
}
</script>
</head>
<body>
<textarea id='code' style='width:100%;height:400px;display:none;'>
({
    path:"file:///G:/_workspace/wednus_platform/",
    version:"0.1.1",
    $:function(id){return document.getElementById(id);},
    js:function(url){document.write("<script type='text/javascript' src='"+ url +"'><\/script>");},
    autopath:function(){if(this.path!=""){return true;}if(document.getElementsByTagName){var scripts=document.getElementsByTagName("script");for(var i=0;i<scripts.length;++i){if(scripts[i].src.match(/\bwednus\.js$/i)||scripts[i].src.match(/\bwednus_compact\.js$/i)){this.path=scripts[i].src.substring(0,scripts[i].src.lastIndexOf("/")+1);return true;}else if(scripts[i].src.match(/\bwednus\.js\?only$/i)){this.path=scripts[i].src.substring(0,scripts[i].src.lastIndexOf("/")+1);return false;}}}document.write("This browser does not support the basic DOM level1.\nTo support this browser,the author of this page needs to set\"W.path\" to the installation path(URL)of Wednus Platform manually. Meanwhile,the platform will be unloaded.\nWe are sorry for this.\n\nWednus team.");document.close();W=null;return false;},
    load:function(subpath,name,lib){lib=lib?lib:"include";this.modules={};if(!this.modules[lib]){this.modules[lib]=[];}name=name.split(",");if(name.length!=1){for(var i=0;i<name.length;++i){this.load(subpath,name[i],lib);}return;}if(getIndex(lib,name)!=-1){return;}else{this.modules[lib][this.modules[lib].length]=name+"";}this.js(this.path+subpath+"/"+name+".js");function getIndex(lib,name){for(var i=0;i<W.modules[lib].length;++i){if(W.modules[lib][i]==name){return i;}}return-1;}},
    css:function(url){document.write("<link href=\""+url+"\" rel=\"stylesheet\" type=\"text/css\">");document.close();},
    modules:null,
    dkernel:null,
    refresh:function(){var db=document.body;if(window.innerWidth!=null){this.width=window.innerWidth;this.height=window.innerHeight;}else if(window.opera!=null){this.width=db.clientWidth;this.height=db.clientHeight;}else if(document.documentE1lement!=null){this.width=document.documentElement.clientWidth;this.height=document.documentElement.clientHeight;}this.width=parseInt(this.width);this.height=parseInt(this.height);this.body.style.width=this.width+"px";this.body.style.height=this.height+"px";},
    scroll:function(isAuto){if(isAuto){document.write("<style>html{overflow:auto;}</style>");}else{document.write("<style>html{overflow:hidden;}</style>");}document.close();},
    background:function(bg){if(!bg){return;}document.body.style.background=bg;},
    init:function(){W.names="";for(var i in window){W.names+=i+",";}this.body=document.createElement("div");this.body.style.display="inline";if(!document.body){document.write("<div id=\"_wednus_platform_\" style=\"display:none;position:absolute;\">.</div>");}document.body.appendChild(this.body);this.code=document.createElement("textarea");this.code.style.display="none";document.body.appendChild(this.code);this.scroll(false);this.refresh();if(this.path==""){this.autopath();}},
    width:894,
    height:777,
    check_namespace:function(){},
    names:"getInterface,window,W,document,netscape,XPCSafeJSObjectWrapper,XPCNativeWrapper,GeckoActiveXObject,Components,sessionStorage,globalStorage,getComputedStyle,dispatchEvent,removeEventListener,name,parent,top,getSelection,scrollByLines,dump,scrollbars,scrollX,scrollY,scrollTo,scrollBy,scrollByPages,sizeToContent,setTimeout,setInterval,clearTimeout,clearInterval,setResizable,captureEvents,releaseEvents,routeEvent,enableExternalCapture,disableExternalCapture,open,openDialog,frames,applicationCache,self,navigator,screen,history,content,menubar,toolbar,locationbar,personalbar,statusbar,directories,closed,crypto,pkcs11,controllers,opener,status,defaultStatus,location,innerWidth,innerHeight,outerWidth,outerHeight,screenX,screenY,pageXOffset,pageYOffset,scrollMaxX,scrollMaxY,length,fullScreen,alert,confirm,prompt,focus,blur,back,forward,home,stop,print,moveTo,moveBy,resizeTo,resizeBy,scroll,close,updateCommands,find,atob,btoa,frameElement,showModalDialog,postMessage,addEventListener,localStorage,",
    body:null,
    code:null,
    events:null,
    event:function(source,evt,func,arg1){var task;if(!W.events[source]){W.events[source]={};}if(!W.events[source][evt]){W.events[source][evt]=[];source[evt]=function(e){for(var i=0;i<W.events[source][evt].length;++i){task=W.events[source][evt][i];if(typeof task[1]!="undefined"){task[0](task[1]);}else if(typeof e!="undefined"){task[0](e);}}};}W.events[source][evt][W.events[source][evt].length]=[func,arg1];},
    c:null,
    a:null,
    u:null,
    include:function(subpath,name){this.load(subpath,name,"include");},
    include_css:function(subpath,name){this.css(this.path+subpath+"/"+name+".css");},
    control:function(name){this.load("control/"+name,name,"control");},
    module:function(name){this.load("module/"+name,name,"module");},
    snippet:function(name){this.load("snippet/"+name,name,"snippet");},
    app:function(name,args){this.load("app/"+name,name,"app");this.event(window,"onload",function(){W.a[name](args);});},
    style:function(obj,wss){if(typeof obj=="string"){obj=document.createElement(obj);}var s=obj.style;var tmp,latestProp;if(!wss){return obj;}wss=wss.split(";");for(var i=0;i<wss.length;++i){tmp=wss[i].split(":");if(typeof tmp[1]=="undefined"){s[tmp[0]]=latestProp;}else{s[tmp[0]]=latestProp=tmp[1];}}return obj;},
    loader:null,
    request:function(url,callback){var jump=this.loader;jump.src=url;jump.onload=function(){var data=jump.contentDocument?jump.contentDocument.body.innerHTML:jump.contentWindow.document.body.innerHTML;data=data.replace(/(<([^>]+)>)/gi,"");if(callback!=null){callback(data);}};},
    proxy_url:"http://wednus.com/wednus_platform/module/dkernel/test/wrs/wrs.php",
    proxy:function(url,callback){if(!callback){callback="";}W.js(W.proxy_url+"?callback="+callback+"&url="+escape(url));},
    opener:null,
    open:function(url){if(!this.opener.isStarted){W.style(W.opener,"width:100%;height:"+W.height+"px;display:block");W.event(window,"onresize",function(){W.refresh();W.opener.style.height=W.height+"px";});this.opener.isStarted=true;}var isLoaded=false;W.opener.src=W.path+"module/dkernel/lib/loading.html";W.opener.onload=function(){load();};W.opener.onreadystatechange=function(){if(this.readyState=="complete"){load();}};function load(){if(!isLoaded){W.opener.src=url;isLoaded=true;}}},
    close:function(){W.opener.style.display="none";W.opener.isStarted=false;},
    wrap:function(obj){var wrapper=document.createElement("div");wrapper.id="_wednus_wrapper_";W.style(wrapper,"position:absolute;width:100%;height:100%;display:block;overflow:auto;");wrapper.appendChild(obj);document.body.appendChild(wrapper);},
    write:function(str){W.style(W.body,"width:100%;height:100%;position:absolute;overflow:auto;");W.body.innerHTML=str;},
    clone:function(){this.code.value=this;return this.code.value;},
    toString:function(isDebug){return this.serialize(this,false);},
    serialize:function(obj,isDebug){if(!isDebug){isDebug=false;}var lineBreak="";var tab="";if(isDebug){lineBreak="\n";tab=" ";}var str="{"+lineBreak;var first=true;for(var i in obj){if(first){first=false;}else{str+=","+lineBreak;}str+=tab+i+":";switch(typeof obj[i]){case "string":str+="\""+obj[i]+"\"";break;case "function":if(i=="js"){str+="function(url){document.write(\"<script type='text/javascript' src='\"+url+\"'><\\/script>\");}";break;}var s="";s+=obj[i];s=s.replace(/\s+/g," ");s=s.replace(/^\s(.*)/,"$1");s=s.replace(/(.*)\s$/,"$1");s=s.replace(/\s([\x21\x25\x26\x28\x29\x2a\x2b\x2c\x2d\x2f\x3a\x3b\x3c\x3d\x3e\x3f\x5b\x5d\x5c\x7b\x7c\x7d\x7e])/g,"$1");str+=s.replace(/([\x21\x25\x26\x28\x29\x2a\x2b\x2c\x2d\x2f\x3a\x3b\x3c\x3d\x3e\x3f\x5b\x5d\x5c\x7b\x7c\x7d\x7e])\s/g,"$1");break;case "object":str+=W.json.stringify(obj[i]);break;default:str+=obj[i];}}return str+lineBreak+"}";},
    removeComments:function(s){var lines,i,t;lines=s.split("\n");t="";for(i=0;i<lines.length;i++){t+=lines[i].replace(/([^\x2f]*)\x2f\x2f.*$/,"$1");}t=t.replace(/(.*)\n(.*)/g,"$1 $2");lines=t.split("*/");t="";for(i=0;i<lines.length;i++){t+=lines[i].replace(/(.*)\x2f\x2a(.*)$/g,"$1 ");}return t;},
    json:null,
    Oracle:function(args){var self=this;if(!W.darwin){W.darwin={oracles:[]};}this.id=W.darwin.oracles.length;this.worlds=[];this.isClockShown=false;W.event(window,"onload",init);W.darwin.oracles[this.id]=this;this.add=function(world){self.worlds[self.worlds.length]=world;world.oracle=self;};this.pause=function(){var world;for(var i=0;i<self.worlds.length;++i){world=self.worlds[i];world.paused=true;}};this.resume=function(){var world;for(var i=0;i<self.worlds.length;++i){world=self.worlds[i];world.paused=false;}};this.showClock=function(isOn){if(self.worlds.length==0){W.event(window,"onload",clock_on_off);}else{clock_on_off();}function clock_on_off(){for(var i=0;i<self.worlds.length;++i){var world=self.worlds[i];if(world.body){if(isOn){if(!world.clock){world.clock=W.style("div","color:lime;fontSize:10px;display:none");world.body.appendChild(world.clock);}world.clock.style.display="block";self.isClockShown=true;}else{world.clock.style.display="none";self.isClockShown=false;}}}}};this.run=function(){var world;for(var i=0;i<self.worlds.length;++i){world=self.worlds[i];if(!world.paused){if(world.ticks==world.delay){if(world.tick){world.tick();}if(self.isClockShown&&world.clock){world.clock.innerHTML=++world.time;}world.ticks=0;}else{++world.ticks;}}}setTimeout("W.darwin.oracles["+self.id+"].run()",0);};function init(){for(var i=0;i<self.worlds.length;++i){var world=self.worlds[i];world.time=0;world.ticks=0;if(!world.delay){world.delay=0;}if(world.body){W.body.appendChild(world.body);}}self.run();}for(var i in args){eval("this."+i+"=args[\""+i+"\"];");}}
})
</textarea>
</body>
</html>